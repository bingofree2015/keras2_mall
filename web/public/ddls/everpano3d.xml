<!-- this project has been generated by everpano 3D v 1.3.2 -->
<krpano 
	debugmode="true"
	version="1.3.2"
	title=""
	idletime="60"
	 
>
  <!--
  logkey ="false"
  onstart="showlog(false)" showerrors="false"
	       _             _           
	 _ __ | |_   _  __ _(_)_ __  ___ 
	| '_ \| | | | |/ _` | | '_ \/ __|
	| |_) | | |_| | (_| | | | | \__ \
	| .__/|_|\__,_|\__, |_|_| |_|___/
	|_|            |___/             
	-->
  <!-- <include url="%VIEWER%/plugins/contextmenu.xml" /> -->
  <!-- <include url="%VIEWER%/plugins/iphone_fullscreen_swipe.xml" /> -->
  <!-- 
                     _           _     _____     _ 
     _ __  _ __ ___ (_) ___  ___| |_  |___ /  __| |
    | '_ \| '__/ _ \| |/ _ \/ __| __|   |_ \ / _` |
    | |_) | | | (_) | |  __/ (__| |_   ___) | (_| |
    | .__/|_|  \___// |\___|\___|\__| |____/ \__,_|
    |_|           |__/                             
    
    -->
  <include url="tour.xml" />
  <include url="xmldate/everpanodate.xml" />
  
 
   <!-- editMode = "false"  显示或隐藏编辑模式 -->
    <plugin name="navigator" keep="true" devices="html5"
        url="%VIEWER%/plugins/navigator.js"
        leftKey = "65"
        rightKey = "68"
        forwardKey = "87"
        backwardKey = "83"
        upKey = "81"  
        downKey  = "69"
        
        
        
        angleTolerance = "60"
        hotspotVisibility = "scene" 
        notFoundMove = "0.2"
        notFoundTime = "0.3"
        navigationMode = "jumping"
        navigationClick = "true"
        navigationSpeed = "11000"
        walkingspeed="10"
        walkingfriction = "0.5"
        walkratiochange="0.8"
       
        loadsceneblendtime = "0.2"
      
        editMode = "false"
        
        loadsceneblend="BLEND " 
    />
  
  <!--

     
                       _             _             
     _ __   __ ___   _(_) __ _  __ _| |_ ___  _ __ 
    | '_ \ / _` \ \ / / |/ _` |/ _` | __/ _ \| '__|
    | | | | (_| |\ V /| | (_| | (_| | || (_) | |   
    |_| |_|\__,_| \_/ |_|\__, |\__,_|\__\___/|_|   
                         |___/                    
              

    leftkey                -> 65                            // A this is the key code that triggers the action
    rightkey               -> 68                            // D this is the key code that triggers the action
    forwardkey             -> 87                            // W this is the key code that triggers the action
    backwardkey            -> 83                            // S this is the key code that triggers the action
    upkey                  -> 81                            // Q this is the key code that triggers the action
    downkey                -> 69                            // E this is the key code that triggers the action
    angletolerance         -> 60                            // this is the angle used to poroject the cone that checks which scenes are on the sight of the user这是用于投影圆锥体的角度，用于检查用户看到的场景
    hotspotvisibility      -> scene                         // model | scene -> that attribute indicates whether I check against all hotspots in the model or just those visible from the pano
                                                              model | scene->该属性指示我是针对模型中的所有热点进行检查，还是仅针对从pano中可见的热点进行检查
    notfoundmove           -> 10                            // the amount of move that it will perform when no image is found in specific direction
                                                                当在特定方向上找不到图像时，它将执行的移动量
    notfoundtime           -> 0.3                           // the amount of time that it will be used to perform the move when no image is found
                                                                未找到图像时执行移动所用的时间量
    navigationmode         -> jumping                       // walking | jumping we can have those 2 types of navigation mode, we could even provide a method to dynamically cahnge the method
                                                                步行|跳跃我们可以有这两种导航模式，我们甚至可以提供一种动态调用该方法的方法
    navigationclick        -> true                          // allow to make click on the screen to navigate允许点击屏幕进行导航
    navigationspeed        -> 100                           // this is the speed that user will be moving around when navigation method is used 这是使用导航方法时用户移动的速度
    walkingspeed           -> 0.1                           // this is the speed that user will be moving around when walking 这是用户行走时移动的速度
    walkingfriction        -> 0.9                           // this is the friction applied while user will be moving around when walking
                                                                这是用户在行走时移动时所施加的摩擦力
    walkratiochange        -> 0.8                           // define in which point of the distance the transition to next pano is performed, values range from 0-1, 0.8 means we should be 80% more far from the current pano to the shortest to change
                                                              定义在距离的哪一点执行到下一个pano的转换，值的范围从0-1到0.8意味着我们应该距离当前pano多80%才能更改
    walktransition         -> true                          // this attribute, defines whether when walking (only in walk mode), the plugin need to perform a view transition to the position of the new found scene, or just keep the current position.该属性定义行走时（仅在行走模式下），插件是否需要执行到新发现场景的位置的视图转换，或者仅保持当前位置。
    loadsceneflags         -> MERGE|KEEPVIEW|KEEPMOVING     // the flags used to perform loadscene  用于执行loadscene的标志
    loadscenevars          -> null                          // the vars used to perform loadscene  用于执行loadscene的vars
    loadsceneblend         -> BLEND                         // the blend used to perform loadscene 用于执行加载场景的混合
    loadsceneblendtime     -> null                          // the blend time used to perform loadscene 用于执行加载场景的混合时间
    modeReturn             -> false                         // By using this mode the plugin will not perform any loadscene, just return to specific var the name of the scene 通过使用此模式，插件将不会执行任何加载场景，只需将场景的名称返回到特定的var
    returnaAction           -> null                         // the krpano action that will be called passing scene name and distance as arguments 将通过场景名称和距离作为参数调用的krpano操作
    returnVRAction         -> null                          // the krpano action that will be called passing scene name and distance as arguments when user is in VR mode 当用户处于VR模式时，将通过场景名称和距离作为参数调用的krpano动作
    returnNotFoundAction   -> null                          // the krpano action that will be called when non scene is found while jumping 当跳跃时发现非场景时将调用的krpano动作
    returnNotFoundVRAction -> null                          // the krpano action that will be called when non scene is found while jumping in VR mode   在VR模式下跳跃时发现非场景时将调用的krpano动作 
    depthmapuse            -> true                          // this attribute is for telling the plugin to perform a transition from scene 2 scene or just make a simple loadscene with zoom, so when we do not have depthmap is going to make nice transitions此属性用于告诉插件从场景2场景执行转换，或者只制作一个带有缩放的简单加载场景，因此当我们没有depthmap时，将进行良好的转换
    hapticfeedback         -> true                          // this attribute let us use the haptic feedback on the controllers to inform the user about if the plugin found or not a new scene after clicking on screen, not used in returnMode此属性允许我们使用控制器上的触觉反馈来通知用户插件在点击屏幕后是否发现了新场景，而不是在returnMode中使用
    
    floorspots             -> false                           // show hotspots on the ground, used when no geometry is drawn in the model在地面上显示热点，当模型中没有绘制几何图形时使用
    floortooltip           -> false                           // show tooltips when over floor hotspots在地板热点上方显示工具提示
    floorStyleSize         -> 20                              // defines the size of the hotspot  定义热点的大小     
    floorStyleBorder       -> 3                               // defines the thickness of the border           
    floorStyleAlpha        -> 0.6                             // defines the global alpha of the hotspot       
    floorStyleBordercolor  -> 0x000000                        // color of the border                       
    floorStyleCirclecolor  -> 0xfafafa                        // color of the inner circle      
    


    modeReturn = "true"
    returnAction = "sceneFound"
    returnNotFoundAction = "sceneNotFound"

    <action name="sceneFound" > 
        debug('we have found %1 at a distance of %2'); 
        loadscene(%1, null, MERGE|KEEPVIEW|KEEPMOVING, BLEN D(0.5)); 
        set(events.onviewloaded, null); 
        set(events.onkeydown, stoptween(view.tx|view.ty|view.tz);set(events.onkeydown,null); ); 
        tween(view.tx|view.ty|view.tz, calc('' + image.ox + '|' + image.oy + '|' + image.oz), 2, default, set(events.onkeydown,null);
    </action><action name="sceneFoundSpeed" > 
        debug('we have found %1 at a distance of %2'); set(distance,%2); set(speed,10); 
        calc(transitionTime,distance / speed); 
        loadscene(%1, null, MERGE|KEEPVIEW|KEEPMOVING, BLEND(0.5)); 
        set(events.onviewloaded, null); 
        set(events.onkeydown, stoptween(view.tx|view.ty|view.tz);set(events.onkeydown,null); ); 
        tween(view.tx|view.ty|view.tz, calc('' + image.ox + '|' + image.oy + '|' + image.oz), get(transitionTime), default, set(events.onkeydown,null);
    </action><action name="sceneNotFound" > 
        txtsplit(%1,'|',p0x,p0z,p1x,p1z); 
        debug('no scene was found, current location is x:', p0x,' z:',p0z,' and click point is x:',p1x,' z:', p1z); 
        tween(view.tx|view.tz, calc(p1x + '|' + p1z) ,0.3, default,tween(view.tx|view.tz, calc( p0x + '|' + p0z) ,0.3, default));
    </action>
    
    -->

 
  <!-- <include url="%VIEWER%/plugins/followmouse.xml" /> -->
  

	<action name='scene_model3d'>
		
	</action> 
  
  
  <action name="generate_floor_hotspots" autorun="" scope="local">
		set(floorheight, 1.84);
		for(set(i,0), i LT style.count, inc(i),
			indexoftxt(is_everpano3D_style, get(style[get(i)].name), 'everpano3d_');
			if(is_everpano3D_style == 0,
				copy(st, style[get(i)]);
				addhotspot(calc('floorspot_' + (i+1)), hs);
				hs.loadstyle(floorspot);
				copy(hs.tx, st.ox);
				copy(hs.tz, st.oz);
				calc(hs.ty, floorheight + 1.0*st.oy - 1.0);
				copy(hs.linkedscene, st.linkedscene);
			);
		);
		loadscene(scene_94,null,null,BLEND(0.5));
		set(isRun,true);
		delayedcall(0.2, set(isRun,false); );	
		asyncloop(isRun, 
			set(view.vlookat,0);
			set(view.hlookat,0);
			
			
		);
	
	</action>

		
		




	


</krpano>
